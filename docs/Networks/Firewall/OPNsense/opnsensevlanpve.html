<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Networks/Firewall/OPNsense/opnsensevlanpve" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">Gestion des vLANS sous PVE avec OPNsense | Louis IT - Administration Systèmes &amp; Réseaux</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://portfolio.ldurand-it.fr/docs/Networks/Firewall/OPNsense/opnsensevlanpve"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Gestion des vLANS sous PVE avec OPNsense | Louis IT - Administration Systèmes &amp; Réseaux"><meta data-rh="true" name="description" content="Introduction &amp; Prérequis"><meta data-rh="true" property="og:description" content="Introduction &amp; Prérequis"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://portfolio.ldurand-it.fr/docs/Networks/Firewall/OPNsense/opnsensevlanpve"><link data-rh="true" rel="alternate" href="https://portfolio.ldurand-it.fr/docs/Networks/Firewall/OPNsense/opnsensevlanpve" hreflang="en"><link data-rh="true" rel="alternate" href="https://portfolio.ldurand-it.fr/docs/Networks/Firewall/OPNsense/opnsensevlanpve" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Louis IT - Administration Systèmes &amp; Réseaux RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Louis IT - Administration Systèmes &amp; Réseaux Atom Feed"><link rel="stylesheet" href="/assets/css/styles.3da58d6e.css">
<script src="/assets/js/runtime~main.628ae10d.js" defer="defer"></script>
<script src="/assets/js/main.804c067d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">Bienvenue sur mon site qui est encore en construction ! 🚧 Je travaille constamment pour le rendre meilleur. 💻 Vos suggestions sont importantes pour moi ! N'hésitez pas à les partager. 🌟</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Louis IT</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Documentations</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Portfolio</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/certifications">Certifications</a></li><li><a class="dropdown__link" href="/skills">Compétences</a></li><li><a class="dropdown__link" href="/projets">Projets</a></li><li><a class="dropdown__link" href="/parcours">Parcours</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://veille.louis-it.fr" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">FreshRSS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://www.youtube.com/channel/UCtYRn3VO0MCFdyS-5MEovyQ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Documentations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Cybersecurity/DecryptagePasswordsJTR">Cybersécurité</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/Networks/Firewall/PfSense/pfsense-install">Réseaux</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/Networks/Firewall/PfSense/pfsense-install">Firewall</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Networks/Firewall/PfSense/pfsense-install">PfSense</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/Networks/Firewall/OPNsense/opnsense-01">OPNsense</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Networks/Firewall/OPNsense/opnsense-01">Installation de OPNsense sur VM (PVE)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Networks/Firewall/OPNsense/opnsensevlanpve">Gestion des vLANS sous PVE avec OPNsense</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Networks/Cisco/CiscoCLI">Cisco</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Systems/Linux/ListesDeCommandes">Systèmes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Services/ctwebpve">Services</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Réseaux</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Firewall</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">OPNsense</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Gestion des vLANS sous PVE avec OPNsense</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Gestion des vLANS sous PVE avec OPNsense</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction--prérequis">Introduction &amp; Prérequis<a href="#introduction--prérequis" class="hash-link" aria-label="Direct link to Introduction &amp; Prérequis" title="Direct link to Introduction &amp; Prérequis">​</a></h2>
<p>Avant tout chose je tient à préciser que ce guide est la version écrite de la vidéo <strong>Optimisez votre Réseau : Déploiement de VLANs sur Proxmox avec OPNsense !</strong> publié sur ma châine YouTube @LouisIT443 le 1er Mars 2024. Je vous invite donc d&#x27;abord à consulter cette vidéo avant de vous lancer dans ce guide.</p>
<p>Dans ce guide nous verrons donc la mise en place et la gestion de VLANS qui sont en réalités des résaux locaux virtualisé qui permettent avant tout de segmenter proprement vos réseaux. Ils permettent aussi de gérer les accès internes à un ensembles de machines qui sont sous le même réseau.</p>
<p><img decoding="async" loading="lazy" alt="MiniatureYouTube" src="/assets/images/opnsensevlanpveshow-0a80e5d9e2a82176a239eaff5e84844f.png" width="1920" height="1080" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Lien</div><div class="admonitionContent_BuS1"><p><strong>Optimisez votre Réseau : Déploiement de VLANs sur Proxmox avec OPNsense !</strong> : <a href="https://youtu.be/UJU-JZ7vs4k" target="_blank" rel="noopener noreferrer">https://youtu.be/UJU-JZ7vs4k</a></p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prérequis">Prérequis<a href="#prérequis" class="hash-link" aria-label="Direct link to Prérequis" title="Direct link to Prérequis">​</a></h3>
<ul>
<li>Avoir une machine OPNsense fonctionnelle. <a href="/docs/Networks/Firewall/OPNsense/opnsense-01">Voir Guide</a></li>
<li>Avoir plusieurs VMBR sur Proxmox (1 Pour les VLANS &amp; 1 Pour L&#x27;Administration de OPNsense)</li>
<li>Avoir deux Machines aui minimum à placer dans différents VLANS pour effectuer des Tests</li>
<li>Une Machine d&#x27;Administration pour gérer l&#x27;interface Web d&#x27;OPNsense <em>(Ex : Windows 11 en RDP)</em></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="création-des-vlans-dans-proxmox">Création des VLANS dans Proxmox<a href="#création-des-vlans-dans-proxmox" class="hash-link" aria-label="Direct link to Création des VLANS dans Proxmox" title="Direct link to Création des VLANS dans Proxmox">​</a></h2>
<p>Pour pouvoir taguer nos interfaces d&#x27;un VLANS sur nos VM il faut renseigner nos futurs VLANS à Proxmox.<br>
<!-- -->Pour se faire rendez vous sur l&#x27;interface Web de PVE et séléctionner votre node (Serveur) pas Datacenter<br>
<!-- -->Dans <strong>network</strong> créer deux Linux VLAN avec comme nom vlanXXX <em>(Ex <!-- -->:vlan100<!-- --> &amp; vlan50)</em>.<br>
<!-- -->Dans l&#x27;emplacement <strong>Vlan raw device</strong> renseignez alors le vmbr que vous avez choisi qui supportera vos VLANs.</p>
<p><img decoding="async" loading="lazy" alt="OPNsensevlanpvve01" src="/assets/images/opnsensevlanpve01-378a8a0831fd8a2ec75118d0255fed12.png" width="582" height="290" class="img_ev3q"></p>
<p>Répétez cette étape autant de fois que vous voulez pour le nombre de VLANs désirés.<br>
<!-- -->Dans mon cas que 2 VLANS. Le VLAN 100 &amp; Le VLAN 50</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Astuce 💡</div><div class="admonitionContent_BuS1"><p>Pour plus de clarté si vous disposer d&#x27;un menu networks déjà chargé utiliser alors l&#x27;emplacement <strong>Comments</strong> pour définir explicitement le rôle d&#x27;un vlan ou dune interface</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ajouts-des-vlans-comme-interfaces-dans-opnsense">Ajouts des VLANS comme Interfaces dans OPNsense<a href="#ajouts-des-vlans-comme-interfaces-dans-opnsense" class="hash-link" aria-label="Direct link to Ajouts des VLANS comme Interfaces dans OPNsense" title="Direct link to Ajouts des VLANS comme Interfaces dans OPNsense">​</a></h2>
<p>Désormais nous avons renseigné nos VLANS à PVE on va pouvoir les renseignés dans OPNsense.<br>
<!-- -->Mais avant de lancer votre machine assurez vous que avez ajoutez votre vmbr supportant les vlans à votre VM OPNsense. N&#x27;indiquez aucun Tag de VLANS</p>
<p><img decoding="async" loading="lazy" alt="OPNsensevlanpvve02" src="/assets/images/opnsensevlanpve02-41e2ff63f41b11880286aa4e8ad3c5dd.png" width="612" height="297" class="img_ev3q"></p>
<p>Dès que vous avez lancer votre OPNsense utlisez maintenant votre machine d&#x27;administration pour joindre son interface Web.</p>
<p>Puis dans la section Interfaces à gauche de votre écran séléctionnez Other-Types puis VLAN.</p>
<p><img decoding="async" loading="lazy" alt="OPNsensevlanpvve03" src="/assets/images/opnsensevlanpve03-13bc4710136f08da7e3167b8df6b5004.png" width="299" height="653" class="img_ev3q"></p>
<p>Ensuite sur cette interface de gestion des VLANS dans OPNsense utliser le petit bouton plus coloré en orange 🟠 pour ajouter de nouveaux VLANS dans OPNsense.</p>
<p>Voici l&#x27;interface d&#x27;ajout d&#x27;un vlan dans OPNsense.</p>
<ul>
<li><em>Device</em> : Renseigner le nom de votre vlan sous cette forme (vlanX.XXX)</li>
<li><em>Parent</em> : Selectionnez l&#x27;interface supportant vos VLANS</li>
<li><em>VLAN Tag</em> : Le Numéro du VLAN.</li>
<li><em>Description</em> : Une descrition explicite du rôle de ce vlan.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="OPNsensevlanpvve04" src="/assets/images/opnsensevlanpve04-1f4c940b4a1f0008c25ce5afff53a6c8.png" width="823" height="382" class="img_ev3q"></p>
<p>Ensuite répéter cette étape en fonction du nombre de vlans que vous souhaitez créer.</p>
<p>Maintenant il va falloir ajouter ces VLANS dans les intefaces de OPNsense pour cela rien de plus simple rendez vous dans la partie <em>Assignments</em> de la catégorie <em>Interfaces</em> de OPNsense puis ajouter les comme nouvelles interface avec une description vos vlans.</p>
<p><img decoding="async" loading="lazy" alt="OPNsensevlanpvve05" src="/assets/images/opnsensevlanpve05-06274d14377b412df33e7b305dc9933c.png" width="800" height="185" class="img_ev3q"></p>
<p>Ensuite vos Interfaces/VLANS apparaissent sur le côté gauche.
Séléctionnez les et activez les puis atttribuer leurs une addresse IP qui sera la passerelle de vos machines de ce VLAN.</p>
<p><img decoding="async" loading="lazy" alt="OPNsensevlanpvve06" src="/assets/images/opnsensevlanpve06-6e82b4c72aab153992c6fccb42a78762.png" width="1439" height="306" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="OPNsensevlanpvve07" src="/assets/images/opnsensevlanpve07-38ed79cdd21dfb1772c33d548dd52fe5.png" width="783" height="545" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ajouts-des-vm-dans-les-vlans">Ajouts des VM dans les VLANS<a href="#ajouts-des-vm-dans-les-vlans" class="hash-link" aria-label="Direct link to Ajouts des VM dans les VLANS" title="Direct link to Ajouts des VM dans les VLANS">​</a></h2>
<p>Après avoir renseigné nos VLANS du côtés de PVE puis de OPNsense il va falloir les renseignés côtés Clientes pour nos VM.<br>
<!-- -->Pour cela allez sur la VM concerné et ajoutez la carte réseaux supportant vos VLANS puis renseignez dans la partie <strong>VLAN Tag</strong> le VLAN que vous voulez &quot;rejoindre&quot;.
Ensuite démarez votre VM et renseignez une adresse dans le VLAN et en passerelle l&#x27;IP de l&#x27;interface correspondant à votre VLAN.</p>
<p>Exemple pour une machine dans le VLAN 100</p>
<p><img decoding="async" loading="lazy" alt="OPNsensevlanpvve08" src="/assets/images/opnsensevlanpve08-1d7eacb6032ef624fffb8fad3cd58ce4.png" width="275" height="102" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="gestion-des-flux-inter-vlans">Gestion des flux inter-vlans<a href="#gestion-des-flux-inter-vlans" class="hash-link" aria-label="Direct link to Gestion des flux inter-vlans" title="Direct link to Gestion des flux inter-vlans">​</a></h2>
<p>On vient de voir comment mettre nos machines dans leurs VLANS respectif mais malheuresement elle ne peuvent pas se joindre entre elles. Avantageux dans certains cas cette isolation du réseau peut être problématique.</p>
<p>Pour remédier à ça on utilise le principe de rêgles dans la catégorie Firewall.<br>
<!-- -->Ces rêgles seront liés à nos VLANS/Interfaces respectives.</p>
<p>Pour mettre en oeuvre ce principe on utlisera une rêgles dites <em>Pass ALL</em>.
Ce qui signifie que tout est autorisé !</p>
<p>On configure cette rêgle sur chaque VLAN.</p>
<p><img decoding="async" loading="lazy" alt="OPNsensevlanpvve09" src="/assets/images/opnsensevlanpve09-820ae6f3c000639eb7c4e8d8da72eb81.png" width="1457" height="399" class="img_ev3q"></p>
<p>Désormais on peut avec une machine du VLAN 50 pinger une machine du VLAN 100</p>
<p><img decoding="async" loading="lazy" alt="OPNsensevlanpvve10" src="/assets/images/opnsensevlanpve10-a3aef27fabbebf4ae074df84831e0d20.png" width="762" height="372" class="img_ev3q"></p>
<p>&amp; Inversement</p>
<p><img decoding="async" loading="lazy" alt="OPNsensevlanpvve11" src="/assets/images/opnsensevlanpve11-e06c57074c302c5efbdc09f95f3696d8.png" width="820" height="426" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="résultat">Résultat<a href="#résultat" class="hash-link" aria-label="Direct link to Résultat" title="Direct link to Résultat">​</a></h2>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Bien Joué ! ✔️</div><div class="admonitionContent_BuS1"><p>Félicitations !  Vous savez désormais comment mettre en place des VLANs sur Proxmox et les administrer avec OPNsense. Ajoutez d&#x27;autres VLANs dans votre réseau et sécuriser les à l&#x27;aide de OPNsense et de sa fonction de rêgles / Firewall.</p></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Liens 🔗</div><div class="admonitionContent_BuS1"><ul>
<li><a href="https://opnsense.org/" target="_blank" rel="noopener noreferrer">https://opnsense.org/</a></li>
<li><a href="https://pve.proxmox.com/wiki/Network_Configuration" target="_blank" rel="noopener noreferrer">https://pve.proxmox.com/wiki/Network_Configuration</a></li>
<li><a href="https://www.zenarmor.com/docs/network-security-tutorials/how-to-configure-vlan-on-opnsense" target="_blank" rel="noopener noreferrer">https://www.zenarmor.com/docs/network-security-tutorials/how-to-configure-vlan-on-opnsense</a></li>
</ul></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Networks/Firewall/OPNsense/opnsense-01"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Installation de OPNsense sur VM (PVE)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Networks/Cisco/CiscoCLI"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Cisco CLI Reference, Howtos, and Tools</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction--prérequis" class="table-of-contents__link toc-highlight">Introduction &amp; Prérequis</a><ul><li><a href="#prérequis" class="table-of-contents__link toc-highlight">Prérequis</a></li></ul></li><li><a href="#création-des-vlans-dans-proxmox" class="table-of-contents__link toc-highlight">Création des VLANS dans Proxmox</a></li><li><a href="#ajouts-des-vlans-comme-interfaces-dans-opnsense" class="table-of-contents__link toc-highlight">Ajouts des VLANS comme Interfaces dans OPNsense</a></li><li><a href="#ajouts-des-vm-dans-les-vlans" class="table-of-contents__link toc-highlight">Ajouts des VM dans les VLANS</a></li><li><a href="#gestion-des-flux-inter-vlans" class="table-of-contents__link toc-highlight">Gestion des flux inter-vlans</a></li><li><a href="#résultat" class="table-of-contents__link toc-highlight">Résultat</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Louis DURAND. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>